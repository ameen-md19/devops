This is the first code from onshore
modification on the code
