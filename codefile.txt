refactored all the code
Ameen is writing continuation code from offshore
